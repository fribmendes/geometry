{"version":1,"ops":[{"type":1,"author":{"id":"33995c4d01b73713061146492fa691fa8865ada5"},"timestamp":1571427253,"metadata":{"github-id":"MDU6SXNzdWU1MDkyNzI1NzI=","github-url":"https://github.com/geometry-zsh/geometry/issues/275","origin":"github"},"title":"geometry_status: bad math expression - operand expected at `\"...\"`","message":"I'm not sure if this is a regression related to the recent autoloading, but I started getting this after pulling the lazy loading feature. The code in `geometry_status` does not appear to have changed recently, which makes this even more puzzling. This seems to happen when `GEOMETRY_STATUS_SYMBOL_COLOR_HASH=true` and attempting to color the prompt:\n\n```shell\nalex@host ~ $ whoami\nalex\ngeometry_status:16: bad math expression: operand expected at `\"88\"'\ngeometry_status:16: bad math expression: operand expected at `\"82\"'\ngeometry_status:16: bad math expression: operand expected at `\"88\"'\ngeometry_status:16: bad math expression: operand expected at `\"52\"'\ngeometry_status:16: bad math expression: operand expected at `\"57\"'\ngeometry_status:16: bad math expression: operand expected at `\"65\"'\ngeometry_status:16: bad math expression: operand expected at `\"56\"'\ngeometry_status:16: bad math expression: operand expected at `\"51\"'\ngeometry_status:16: bad math expression: operand expected at `\"70\"'\n```\n\nIn any case, I've resolved the issue by doing the following:\n\n```diff\ndiff --git a/functions/geometry_status b/functions/geometry_status\nindex 48d7cf1..30f2fa0 100644\n--- a/functions/geometry_status\n+++ b/functions/geometry_status\n@@ -16,7 +16,7 @@ geometry_status() {\n         colors=(${GEOMETRY_STATUS_SYMBOL_COLOR_HASH_COLORS})\n       fi\n\n-      local sum=0; for c in ${(s::)^HOST}; do ((sum += \"$(print -f '%d' \"'$c\")\")); done\n+      local sum=0; for c in ${(s::)^HOST}; do ((sum += $(print -f '%d' \"'$c\") )); done\n\n       local index=\"$(($sum % ${#colors}))\"\n\n```\n\nI can make a PR to fix the issue or you can apply the patch yourself, I just want to make sure that this is not an issue on my end before making code changes.\n\nCheers,\nAlex","files":null}]}